!function(e){var t={};function i(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=8)}([function(e,t,i){e.exports=i.p+"img/player-new.png"},function(e,t,i){e.exports=i.p+"img/dungeon_sheet.png"},function(e){e.exports={murdoc:{display_name:"Murdoc",default:{speech:["You look lost.","What's that, you are lost?","Well, you're in The Desolate Cave.","Be careful. There are bandits running around here."]}}}},function(e){e.exports={knight:{display_name:"Knight",default:{stats:{hp:5,atk:2,def:0,sp_atk:0,sp_de:0,spd:0}}}}},function(e,t,i){e.exports=i.p+"img/knight.png"},function(e){e.exports={height:18,infinite:!1,layers:[{data:[55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,0,0,0,0,0,0,55,55,55,55,0,0,0,0,0,0,0,0,0,0,0,0,55,55,55,55,0,0,0,0,0,0],height:18,id:19,name:"floor",opacity:1,type:"tilelayer",visible:!0,width:16,x:0,y:0},{data:[6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,30,31,31,31,31,31,31,31,31,31,31,31,31,31,31,32,54,0,0,0,0,0,0,0,0,0,0,0,0,0,0,56,54,0,0,0,0,238,238,238,238,0,0,0,0,0,0,56,54,0,0,238,238,238,238,238,238,0,0,0,0,238,238,56,54,0,0,238,238,238,238,238,238,0,0,0,0,238,238,56,54,0,0,238,238,238,238,238,238,0,0,0,0,238,238,56,54,0,0,238,238,238,238,238,238,0,0,0,0,238,238,56,54,0,0,238,238,238,238,238,238,0,0,0,0,238,238,56,54,0,0,238,238,238,238,238,238,0,0,0,0,238,238,56,54,0,0,238,238,238,238,238,238,0,0,0,0,238,238,56,54,0,0,238,238,238,238,238,238,0,0,0,0,238,238,56,54,0,0,238,238,0,238,238,238,0,0,0,0,238,238,56,54,0,0,0,0,0,0,0,0,0,0,0,0,0,0,56,54,0,0,0,0,0,0,0,0,0,0,0,0,0,0,56,78,79,79,79,79,79,10,0,0,9,79,79,79,79,79,80,26,26,26,26,26,26,54,0,0,56,26,26,26,26,26,26,26,26,26,26,26,26,54,0,0,56,26,26,26,26,26,26],height:18,id:20,name:"walls",opacity:1,type:"tilelayer",visible:!0,width:16,x:0,y:0},{draworder:"topdown",id:10,name:"player_start_0.1",objects:[{height:20,id:46,name:"",rotation:0,type:"",visible:!0,width:8,x:124,y:260}],opacity:1,type:"objectgroup",visible:!0,x:0,y:0},{draworder:"topdown",id:11,name:"player_start_0.0",objects:[{height:32,id:44,name:"",rotation:0,type:"",visible:!0,width:12,x:122,y:112}],opacity:1,type:"objectgroup",visible:!0,x:0,y:0},{draworder:"topdown",id:12,name:"config",objects:[],opacity:1,properties:[{name:"level",type:"string",value:"0.0"}],type:"objectgroup",visible:!0,x:0,y:0},{draworder:"topdown",id:9,name:"portal",objects:[{height:8,id:29,name:"",rotation:0,type:"",visible:!0,width:40,x:108,y:280}],opacity:1,properties:[{name:"portal_from",type:"string",value:"0.0"},{name:"portal_to",type:"string",value:"0.1"}],type:"objectgroup",visible:!0,x:0,y:0},{draworder:"topdown",id:5,name:"collision",objects:[{height:32,id:47,name:"",rotation:0,type:"",visible:!0,width:255.636363636364,x:.363636363636364,y:0},{height:224,id:49,name:"",rotation:0,type:"",visible:!0,width:14,x:242,y:32},{height:224,id:50,name:"",rotation:0,type:"",visible:!0,width:16,x:0,y:32},{height:14,id:51,name:"",rotation:0,type:"",visible:!0,width:93,x:151,y:242},{height:14,id:52,name:"",rotation:0,type:"",visible:!0,width:93,x:12,y:242},{height:46,id:54,name:"",rotation:0,type:"",visible:!0,width:16,x:148,y:242},{height:46,id:55,name:"",rotation:0,type:"",visible:!0,width:16,x:92,y:242}],opacity:1,type:"objectgroup",visible:!0,x:0,y:0}],nextlayerid:21,nextobjectid:56,orientation:"orthogonal",renderorder:"right-down",tiledversion:"1.2.3",tileheight:16,tilesets:[{firstgid:1,source:"C:/Users/Anthony/Desktop/maps/dungeon_tiles.tsx"}],tilewidth:16,type:"map",version:1.2,width:16}},function(e){e.exports={height:20,infinite:!1,layers:[{data:[55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55],height:20,id:12,name:"floor",opacity:1,type:"tilelayer",visible:!0,width:32,x:0,y:0},{data:[6,7,7,7,7,7,7,7,7,7,7,7,8,26,26,26,26,26,54,0,56,26,26,26,26,26,26,26,26,26,26,26,30,31,31,31,31,31,31,31,31,31,31,31,32,26,26,26,6,7,58,0,57,7,7,7,7,7,7,7,7,7,7,8,54,0,213,0,0,0,0,213,0,0,0,0,56,26,26,26,30,31,82,0,81,31,31,31,31,31,31,31,31,31,31,32,54,213,213,213,213,19,20,213,0,0,0,0,56,26,26,26,54,0,0,0,0,0,0,0,0,0,0,0,0,0,0,56,54,213,213,213,213,43,44,213,0,0,0,0,56,26,26,26,54,0,0,0,0,0,0,0,0,9,79,79,79,10,0,56,54,213,213,213,213,67,68,213,0,0,0,0,56,26,26,26,54,0,0,0,0,0,0,0,0,56,26,26,26,54,0,56,54,213,213,213,213,0,0,213,0,0,0,0,56,26,26,26,54,0,0,0,0,0,0,0,0,56,26,26,26,54,0,56,54,0,213,213,213,19,20,0,0,0,0,0,56,26,26,26,54,0,0,0,0,0,0,0,0,56,26,26,26,54,0,56,54,0,213,213,213,43,44,0,0,0,0,0,56,26,26,26,78,79,79,79,79,79,79,79,79,80,26,26,26,54,0,56,54,0,0,0,0,67,68,0,0,0,0,0,57,7,7,7,7,7,7,7,7,7,7,7,7,106,7,7,7,58,0,56,54,0,0,0,0,0,0,0,0,0,0,0,81,31,31,31,31,31,31,31,31,31,31,31,31,129,31,31,31,82,0,56,54,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,56,78,79,79,79,10,0,0,9,79,79,79,79,79,79,79,10,0,9,79,79,79,79,79,79,79,79,79,79,79,79,79,80,26,26,26,26,54,0,0,56,26,26,26,26,26,26,26,54,0,56,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,54,0,0,56,26,26,26,26,26,26,26,54,0,57,7,7,7,7,7,7,7,7,7,7,7,7,7,8,26,26,26,26,54,0,0,56,26,26,26,26,26,26,26,54,0,81,31,31,31,31,31,31,31,31,31,31,31,31,31,32,26,26,26,26,54,0,0,56,26,26,26,26,26,26,26,54,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,56,26,26,26,26,54,0,0,56,26,26,26,26,26,26,26,78,79,79,79,79,79,79,79,79,79,79,10,0,0,189,0,56,26,26,26,26,54,0,0,56,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,54,0,0,0,0,56,26,26,26,26,54,0,0,56,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,78,79,79,79,79,80],height:20,id:13,name:"walls",opacity:1,type:"tilelayer",visible:!0,width:32,x:0,y:0},{draworder:"topdown",id:6,name:"player_start_0.0",objects:[{height:24,id:14,name:"",rotation:0,type:"",visible:!0,width:8,x:309,y:8}],opacity:1,type:"objectgroup",visible:!0,x:0,y:0},{draworder:"topdown",id:14,name:"npcs",objects:[{height:16,id:37,name:"",properties:[{name:"name",type:"string",value:"murdoc"}],rotation:0,type:"",visible:!0,width:16,x:464,y:272}],opacity:1,type:"objectgroup",visible:!0,x:0,y:0},{draworder:"topdown",id:15,name:"enemies",objects:[{height:20,id:38,name:"",properties:[{name:"type",type:"string",value:"knight"}],rotation:0,type:"",visible:!0,width:10,x:288,y:64}],opacity:1,type:"objectgroup",visible:!0,x:0,y:0},{draworder:"topdown",id:8,name:"player_start_0.2",objects:[{height:24,id:16,name:"",rotation:0,type:"",visible:!0,width:8,x:92,y:288}],opacity:1,type:"objectgroup",visible:!0,x:0,y:0},{draworder:"topdown",id:7,name:"config",objects:[],opacity:1,properties:[{name:"level",type:"string",value:"0.1"}],type:"objectgroup",visible:!0,x:0,y:0},{draworder:"topdown",id:3,name:"collision",objects:[{height:126,id:19,name:"",rotation:0,type:"",visible:!0,width:80,x:0,y:194},{height:126,id:22,name:"",rotation:0,type:"",visible:!0,width:144,x:112,y:194},{height:62,id:23,name:"",rotation:0,type:"",visible:!0,width:240,x:272,y:194},{height:46,id:24,name:"",rotation:0,type:"",visible:!0,width:176,x:256,y:274},{height:64,id:25,name:"",rotation:0,type:"",visible:!0,width:13,x:499,y:256},{height:14,id:26,name:"",rotation:0,type:"",visible:!0,width:67,x:432,y:306},{height:138,id:27,name:"",rotation:0,type:"",visible:!0,width:73,x:196,y:0},{height:46,id:28,name:"",rotation:0,type:"",visible:!0,width:281,x:196,y:130},{height:66,id:29,name:"",rotation:0,type:"",visible:!0,width:73,x:404,y:64},{height:48,id:30,name:"",rotation:0,type:"",visible:!0,width:188,x:324,y:0},{height:146,id:31,name:"",rotation:0,type:"",visible:!0,width:11,x:501,y:48},{height:32,id:32,name:"",rotation:0,type:"",visible:!0,width:196,x:0,y:0},{height:162,id:33,name:"",rotation:0,type:"",visible:!0,width:13,x:0,y:32},{height:40,id:34,name:"",rotation:0,type:"",visible:!0,width:26,x:83,y:51},{height:40,id:35,name:"",rotation:0,type:"",visible:!0,width:26,x:83,y:115},{height:48,id:36,name:"",rotation:0,type:"",visible:!0,width:33,x:269,y:0}],opacity:1,type:"objectgroup",visible:!0,x:0,y:0},{draworder:"topdown",id:5,name:"portal",objects:[{height:8,id:11,name:"",properties:[{name:"portal_to",type:"string",value:"1.0"}],rotation:0,type:"",visible:!0,width:22,x:302,y:0}],opacity:1,properties:[{name:"portal_from",type:"string",value:"0.1"},{name:"portal_to",type:"string",value:"0.0"}],type:"objectgroup",visible:!0,x:0,y:0},{draworder:"topdown",id:9,name:"portal",objects:[{height:8,id:18,name:"",properties:[{name:"portal_to",type:"string",value:"1.0"}],rotation:0,type:"",visible:!0,width:32,x:80,y:312}],opacity:1,properties:[{name:"portal_from",type:"string",value:"0.1"},{name:"portal_to",type:"string",value:"0.2"}],type:"objectgroup",visible:!0,x:0,y:0}],nextlayerid:16,nextobjectid:39,orientation:"orthogonal",renderorder:"right-down",tiledversion:"1.2.3",tileheight:16,tilesets:[{firstgid:1,source:"C:/Users/Anthony/Desktop/maps/dungeon_tiles.tsx"}],tilewidth:16,type:"map",version:1.2,width:32}},function(e){e.exports={height:16,infinite:!1,layers:[{data:[55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55],height:16,id:3,name:"floor",opacity:1,type:"tilelayer",visible:!0,width:24,x:0,y:0},{data:[6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,30,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,32,54,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,56,54,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,56,54,0,0,0,9,79,79,79,79,79,10,0,0,9,79,79,79,79,79,79,10,0,0,56,0,0,0,0,56,6,7,7,7,7,58,0,0,57,7,7,7,7,7,8,54,0,0,56,0,0,0,0,56,30,31,31,31,31,82,0,0,81,31,31,31,31,31,32,54,0,0,56,54,0,0,0,56,54,0,0,0,0,0,0,0,0,0,0,0,0,0,56,54,0,0,56,54,0,0,0,56,54,0,0,0,0,0,0,0,0,0,0,0,0,0,56,54,0,0,56,54,0,0,0,56,54,0,0,0,0,0,0,0,0,0,0,0,0,0,56,54,0,0,56,54,0,0,0,56,78,79,79,79,79,79,79,79,79,79,79,79,79,79,80,54,0,0,56,54,0,0,0,57,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,58,0,0,56,54,0,0,0,81,31,169,31,169,31,169,31,169,31,169,31,169,31,169,31,82,0,0,56,54,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,56,54,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,56,78,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,80],height:16,id:4,name:"walls",opacity:1,type:"tilelayer",visible:!0,width:24,x:0,y:0},{draworder:"topdown",id:5,name:"collision",objects:[{height:32,id:1,name:"",rotation:0,type:"",visible:!0,width:384,x:0,y:0},{height:96,id:2,name:"",rotation:0,type:"",visible:!0,width:0,x:384,y:16},{height:224,id:4,name:"",rotation:0,type:"",visible:!0,width:16,x:368,y:32},{height:144,id:5,name:"",rotation:0,type:"",visible:!0,width:16,x:0,y:112},{height:48,id:6,name:"",rotation:0,type:"",visible:!0,width:16,x:0,y:32},{height:48,id:9,name:"",rotation:0,type:"",visible:!0,width:32,x:64,y:112},{height:48,id:10,name:"",rotation:0,type:"",visible:!0,width:32,x:304,y:112},{height:37,id:12,name:"",rotation:0,type:"",visible:!0,width:128,x:208,y:75.25},{height:37,id:13,name:"",rotation:0,type:"",visible:!0,width:112,x:64,y:75},{height:48,id:14,name:"",rotation:0,type:"",visible:!0,width:272,x:64,y:160},{height:16,id:16,name:"",rotation:0,type:"",visible:!0,width:352,x:16,y:240}],opacity:1,type:"objectgroup",visible:!0,x:0,y:0},{draworder:"topdown",id:6,name:"portal",objects:[{height:32,id:18,name:"",properties:[{name:"portal_from",type:"string",value:"0.2"},{name:"portal_to",type:"string",value:"0.1"}],rotation:0,type:"",visible:!0,width:8,x:0,y:80}],opacity:1,properties:[{name:"portal_from",type:"string",value:"0.2"},{name:"portal_to",type:"string",value:"0.1"}],type:"objectgroup",visible:!0,x:0,y:0},{draworder:"topdown",id:7,name:"player_start_0.1",objects:[{height:32,id:19,name:"",rotation:0,type:"",visible:!0,width:8,x:8,y:80}],opacity:1,type:"objectgroup",visible:!0,x:0,y:0}],nextlayerid:8,nextobjectid:20,orientation:"orthogonal",renderorder:"right-down",tiledversion:"1.2.3",tileheight:16,tilesets:[{firstgid:1,source:"C:/Users/Anthony/Desktop/maps/dungeon_tiles.tsx"}],tilewidth:16,type:"map",version:1.2,width:24}},function(e,t,i){i(10),e.exports=i(9)},function(e,t,i){},function(e,t,i){"use strict";i.r(t);var n={debug:!1,scale:3};function r(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=function(){function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.x=t,this.y=i}var t,i,n;return t=e,(i=[{key:"copy",value:function(){return new e(this.x,this.y)}},{key:"times",value:function(t){return new e(this.x*t,this.y*t)}}])&&r(t.prototype,i),n&&r(t,n),e}();function a(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var s=function(){function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.pos=t.times(n.scale),this.size=i,this.inDialogue,this.locked=!1,this.lastPos=t.copy()}var t,i,r;return t=e,(i=[{key:"update",value:function(e){}},{key:"collidesWith",value:function(e){var t=this.collisionPoint();return!!(t.x>e.pos.x&&t.x<e.pos.x+e.size.x&&t.y>e.pos.y&&t.y<e.pos.y+e.size.y)&&{pos:e.pos.copy(),size:e.size.copy()}}},{key:"collisionPoint",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return new o((e?this.lastPos.x:this.pos.x)+.5*this.size.x,(e?this.lastPos.y:this.pos.y)+.8*this.size.y)}},{key:"draw",value:function(e){n.debug&&this.debugDraw(e),this.lastPos.x=this.pos.x,this.lastPos.y=this.pos.y}},{key:"debugDraw",value:function(e){e.fillStyle="#F99",e.fillRect(this.pos.x,this.pos.y,this.size.x,this.size.y)}},{key:"resetPos",value:function(e){var t=this.collisionPoint(!0);e?t.x<e.pos.x||t.x>e.pos.x+e.size.x?this.pos.x=this.lastPos.x:this.pos.y=this.lastPos.y:(this.pos.x=this.lastPos.x,this.pos.y=this.lastPos.y)}},{key:"lock",value:function(){this.locked=!0}},{key:"unlock",value:function(){this.inDialogue||(this.locked=!1)}}])&&a(t.prototype,i),r&&a(t,r),e}(),l=i(0),u=i.n(l);function c(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var h=function(){function e(t){var i=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:9,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:9,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:4,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.img=new Image,this.img.src=t,this.scale=n,this.frame=r,this.startFrame=r,this.frameCount=o,this.framesX=a,this.framesY=s,this.speed=l,this.animTime=(new Date).getTime(),this.img.onload=function(){i.subWidth=i.img.width/i.framesX,i.subHeight=i.img.height/i.framesY}}var t,i,n;return t=e,(i=[{key:"draw",value:function(e){var t=(new Date).getTime();t>=this.animTime&&(this.frame++,this.animTime=t+1e3/this.speed),this.frame>this.startFrame+this.frameCount&&(this.frame=this.startFrame);var i=this.frame%this.framesX*this.subWidth,n=Math.floor(this.frame/this.framesX)*this.subHeight;e.drawImage(this.img,i,n,this.subWidth,this.subHeight,0,0,this.subWidth*this.scale,this.subHeight*this.scale)}}])&&c(t.prototype,i),n&&c(t,n),e}();function f(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var p=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.menu=t,this.selected=[],this.active=!0,this.selected.push(this.menu[0]),_handler.register(this)}var t,i,n;return t=e,(i=[{key:"select",value:function(){var e=this.currentOption;e.hasOwnProperty("menu")&&e.menu.length?this.selected.push(e.menu[0]):e.hasOwnProperty("action")&&e.action(this)}},{key:"back",value:function(){if(this.selected.length>1)return this.selected.pop();this.active=!1}},{key:"previousOption",value:function(){var e=this.selected.length>1?this.selected[this.selected.length-2].menu:this.menu,t=this.currentOption,i=e.reduce(function(e,i,n){return i===t?n:e},0);this.selected[this.selected.length-1]=0===i?e[e.length-1]:e[i-1]}},{key:"nextOption",value:function(){var e=this.selected.length>1?this.selected[this.selected.length-2].menu:this.menu,t=this.currentOption,i=e.reduce(function(e,i,n){return i===t?n:e},0);i===e.length-1?this.selected[this.selected.length-1]=e[0]:this.selected[this.selected.length-1]=e[i+1]}},{key:"draw",value:function(e,t,i,n){}},{key:"register",value:function(){var e=this;return{keyup:function(t){if(e.active){if("Escape"===t.key)return e.active=!1;switch(t.key){case"ArrowRight":case"Enter":e.select();break;case"ArrowLeft":case"Backspace":e.back();break;case"ArrowUp":e.previousOption();break;case"ArrowDown":e.nextOption()}}}}}},{key:"currentOption",get:function(){return this.selected[this.selected.length-1]}}])&&f(t.prototype,i),n&&f(t,n),e}();function y(e){return(y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function d(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function b(e,t){return!t||"object"!==y(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function v(e,t,i){return(v="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,i){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=g(e)););return e}(e,t);if(n){var r=Object.getOwnPropertyDescriptor(n,t);return r.get?r.get.call(i):r.value}})(e,t,i||e)}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function m(e,t){return(m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var w=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);return(e=b(this,g(t).call(this,[{type:"item",description:"Items",menu:[]},{type:"equipable",description:"Equipment",menu:[]},{type:"special",description:"Special",menu:[]}]))).active=!1,e.equipped={weapon:null,armor:null,spell:null},e}var i,n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&m(e,t)}(t,p),i=t,(n=[{key:"store",value:function(e){this.menu.filter(function(t){return t.type===e.type})[0].menu.push(e)}},{key:"draw",value:function(e,t,i,n){var r=this;e.save(),e.translate(-n.x,-n.y),e.fillStyle="rgba(200, 200, 200, .96)",e.fillRect(0,0,t,i),e.fillStyle="#75A",e.textAlign="left";var a=this.currentOption;this.selected.reduce(function(t,i,n){var s=n>0?r.selected[n-1].menu:r.menu;return t+s.reduce(function(r,s,l){var u=new o(48+200*n,48+48*(l+t+1));return e.save(),e.font="24px Arial",s===a&&(e.shadowColor="#75A",e.shadowOffsetX=2,e.shadowOffsetY=2,e.shadowBlur=4,e.font="bold 24px Arial"),e.fillText(s.description,u.x,u.y),e.restore(),r+(s===i?l:0)},0)},0),e.restore()}},{key:"register",value:function(){var e=this;return[v(g(t.prototype),"register",this).call(this),{keyup:function(t){"i"===t.key&&(e.active=!e.active)}}]}}])&&d(i.prototype,n),r&&d(i,r),t}();var x=function e(t){for(var i in function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t)this[i]=t[i];this.type="equipable"};function k(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var O=function(){function e(t){for(var i in function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t)this["base_"+i]=t[i];this.lvl=1,this.experience=0,this.damage=0}var t,i,n;return t=e,(i=[{key:"hp",get:function(){return this.base_hp-this.damage}},{key:"atk",get:function(){return this.base_atk}},{key:"def",get:function(){return this.base_def}},{key:"sp_atk",get:function(){return this.base_sp_atk}},{key:"sp_def",get:function(){return this.base_sp_def}},{key:"spd",get:function(){return this.base_spd}},{key:"givesExperience",get:function(){return this.base_hp+this.base_atk+this.base_def+this.base_sp_atk+this.base_sp_def+this.base_spd}}])&&k(t.prototype,i),n&&k(t,n),e}();function _(e){return(_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function j(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function P(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function S(e,t,i){return(S="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,i){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=E(e)););return e}(e,t);if(n){var r=Object.getOwnPropertyDescriptor(n,t);return r.get?r.get.call(i):r.value}})(e,t,i||e)}function E(e){return(E=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function T(e,t){return(T=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var A=function(e){function t(e,i){var n,r,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(n=!(a=E(t).call(this,e,i))||"object"!==_(a)&&"function"!=typeof a?P(r):a).speed=new o(0,0),n.maxSpeed=i.x/10,n.direction=0,n.sprites=[new h(u.a,2,0,0,1,4,8),new h(u.a,2,3,0,1,4,8),new h(u.a,2,2,0,1,4,8),new h(u.a,2,0,0,1,4,8),new h(u.a,2,1,0,1,4,8)],n.stats=new O({hp:10,atk:2,def:0,sp_atk:0,sp_def:0,spd:1}),n.inventory=new w,n.weapon=null,n.spells=[],_handler.register(P(n)),n.init(),n}var i,n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&T(e,t)}(t,s),i=t,(n=[{key:"update",value:function(e){this.locked||(this.pos.x+=this.speed.x,this.pos.y+=this.speed.y,S(E(t.prototype),"update",this).call(this))}},{key:"draw",value:function(e){S(E(t.prototype),"draw",this).call(this,e),e.save(),e.translate(this.pos.x,this.pos.y),this.sprites[this.direction].draw(e),e.restore()}},{key:"move",value:function(e){switch(e){case"ArrowLeft":this.speed.x=-this.maxSpeed;break;case"ArrowDown":this.speed.y=this.maxSpeed;break;case"ArrowRight":this.speed.x=this.maxSpeed;break;case"ArrowUp":this.speed.y=-this.maxSpeed}this.changeDirection()}},{key:"stop",value:function(e){"ArrowLeft"===e&&this.speed.x<0&&(this.speed.x=0),"ArrowRight"===e&&this.speed.x>0&&(this.speed.x=0),"ArrowUp"===e&&this.speed.y<0&&(this.speed.y=0),"ArrowDown"===e&&this.speed.y>0&&(this.speed.y=0),this.changeDirection()}},{key:"changeDirection",value:function(){this.locked||(this.speed.x>0?this.direction=4:this.speed.x<0?this.direction=2:this.speed.y>0?this.direction=3:this.speed.y<0&&(this.direction=1))}},{key:"register",value:function(){var e=this;return{keydown:function(t){t.key.match(/Arrow/)&&e.move(t.key)},keyup:function(t){t.key.match(/Arrow/)&&e.stop(t.key)}}}},{key:"init",value:function(){this.inventory.store(new x({name:"Basic Sword",description:"A basic bish sword.",attack:3})),this.inventory.store(new x({name:"Mace",description:"An effing mace. Watch out!",attack:10})),this.inventory.store(new x({name:"Pole Arm",description:"Swift and strong.",attack:5})),this.weapon=new x({name:"Basic Sword",description:"A basic bish sword.",attack:3})}},{key:"name",get:function(){return"player"}},{key:"dialogueName",get:function(){return"Me"}}])&&j(i.prototype,n),r&&j(i,r),t}(),R=i(1),C=i.n(R);function D(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var F=function(){function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.pos=t||new o(0,0),this.size=i||new o(0,0)}var t,i,r;return t=e,(i=[{key:"update",value:function(e,t){}},{key:"draw",value:function(e){n.debug&&(e.strokeStyle="#F00",e.strokeRect(this.pos.x,this.pos.y,this.size.x,this.size.y))}}])&&D(t.prototype,i),r&&D(t,r),e}();function z(e){return(z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function W(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function M(e,t){return!t||"object"!==z(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function B(e,t,i){return(B="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,i){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=L(e)););return e}(e,t);if(n){var r=Object.getOwnPropertyDescriptor(n,t);return r.get?r.get.call(i):r.value}})(e,t,i||e)}function L(e){return(L=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function U(e,t){return(U=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var I=function(e){function t(e,i){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),M(this,L(t).call(this,e,i))}var i,n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&U(e,t)}(t,F),i=t,(n=[{key:"draw",value:function(e){B(L(t.prototype),"draw",this).call(this,e)}}])&&W(i.prototype,n),r&&W(i,r),t}(),H=i(2);function q(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var N=function(){function e(t,i){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.texts=t,this.entity=i,this.player=n,this.currentText="",this.index=0,this.waiting=!1,this.done=!1,this.frameLength=1e3/24,this.timeStore=0,this.entity.lock(),this.entity.inDialogue=!0,this.player.lock(),this.player.inDialogue=!0,_handler.register(this)}var t,i,n;return t=e,(i=[{key:"update",value:function(e){if(!this.waiting){for(this.timeStore+=e;this.timeStore>this.frameLength;)this.currentText=this.texts[this.index].substring(0,this.currentText.length+1),this.timeStore-=this.frameLength;return this.currentText===this.texts[this.index]?this.waiting=!0:void 0}}},{key:"draw",value:function(e,t){e.save(),e.translate(32-t.x,48-t.y),e.font="30px Arial",e.fillStyle="#FFF",e.fillText(this.entity.dialogueName+": "+this.currentText,0,0),e.restore()}},{key:"register",value:function(){var e=this;return{keyup:function(t,i){"Enter"===t.key&&e.next(),e.done&&i.unregister(e)}}}},{key:"next",value:function(e){this.waiting&&!this.done&&(this.index+1<this.texts.length?(this.index++,this.timeStore=0,this.currentText="",this.waiting=!1):(this.done=!0,this.entity.inDialogue=!1,this.entity.unlock(),this.player.inDialogue=!1,this.player.unlock()))}}])&&q(t.prototype,i),n&&q(t,n),e}();function X(e){return(X="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Y(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function $(e){return($=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function K(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function G(e,t){return(G=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var J=function(e){function t(e,i){var n,r,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,n=!(a=$(t).call(this,new o(e.x,e.y),new o(e.width,e.height)))||"object"!==X(a)&&"function"!=typeof a?K(r):a;var s=e.properties.filter(function(e){return"name"===e.name})[0].value,l=H[s];if(!l)throw new Error("NPC data for "+s+" is not defined in npcs.json");return n.name=s,n.npc=l,n.dialogue=null,n.playerRef=i,_handler.register(K(n)),n}var i,n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&G(e,t)}(t,s),i=t,(n=[{key:"speak",value:function(){!this.dialogue&&this.collidesWith(this.playerRef)&&(this.dialogue=new N(this.npc.default.speech,this,this.playerRef))}},{key:"update",value:function(e,t){this.dialogue&&this.dialogue.done?this.dialogue=null:this.dialogue&&this.dialogue.update(e)}},{key:"draw",value:function(e,t){this.dialogue&&this.dialogue.draw(e,t)}},{key:"register",value:function(){var e=this;return{keyup:function(t){" "!==t.key&&"Enter"!==t.key||e.speak()}}}},{key:"dialogueName",get:function(){return this.npc.display_name}}])&&Y(i.prototype,n),r&&Y(i,r),t}(),Q=i(3),V=i(4);function Z(e){return(Z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ee(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function te(e,t){return!t||"object"!==Z(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ie(e,t,i){return(ie="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,i){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ne(e)););return e}(e,t);if(n){var r=Object.getOwnPropertyDescriptor(n,t);return r.get?r.get.call(i):r.value}})(e,t,i||e)}function ne(e){return(ne=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function re(e,t){return(re=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var oe={knight:i.n(V).a},ae=function(e){function t(e,i){var n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=te(this,ne(t).call(this,new o(e.x,e.y),new o(e.width,e.height)));var r=e.properties.filter(function(e){return"type"===e.name})[0].value,a=Q[r];if(!a)throw new Error("Enemy data for "+name+" is not defined in enemies.json");n.type=r,n.data=a,n.dialogue=null,n.playerRef=i,n.stats=new O(a.default.stats);var s=oe[n.type];return n.sprites=[new h(s,2,0,0,1,4,8),new h(s,2,3,0,1,4,8),new h(s,2,2,0,1,4,8),new h(s,2,0,0,1,4,8),new h(s,2,1,0,1,4,8)],n.direction=4,n}var i,n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&re(e,t)}(t,s),i=t,(n=[{key:"fight",value:function(e){_handler.trigger("battle",{player:this.playerRef,enemy:this})}},{key:"update",value:function(e,t){this.collidesWith(this.playerRef)&&this.fight(this.playerRef)}},{key:"draw",value:function(e){ie(ne(t.prototype),"draw",this).call(this,e),e.save(),e.translate(this.pos.x,this.pos.y),this.sprites[this.direction].draw(e),e.restore()}},{key:"dialogueName",get:function(){return this.data.display_name}}])&&ee(i.prototype,n),r&&ee(i,r),t}();function se(e){return(se="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function le(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ue(e,t){return!t||"object"!==se(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ce(e,t,i){return(ce="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,i){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=he(e)););return e}(e,t);if(n){var r=Object.getOwnPropertyDescriptor(n,t);return r.get?r.get.call(i):r.value}})(e,t,i||e)}function he(e){return(he=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function fe(e,t){return(fe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var pe=function(e){function t(e,i,n){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=ue(this,he(t).call(this,e,i)),n&&n.properties&&n.properties.forEach(function(e){r[e.name]=e.value}),r}var i,n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fe(e,t)}(t,F),i=t,(n=[{key:"draw",value:function(e){ce(he(t.prototype),"draw",this).call(this,e)}}])&&le(i.prototype,n),r&&le(i,r),t}();function ye(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var de=function(){function e(t,i,r){var a=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.data=t,this.player=r,this.pos={x:0,y:0},this.scale=n.scale,this.config={},this.renderable=new h(i,this.scale,0,240,24,10,0),this.playerClips=[],this.portals=[],this.npcs=[],this.enemies=[],this.playerStarts={},this.data.layers.forEach(function(e){"objectgroup"===e.type&&e.objects.forEach(function(t){var i=new o(t.x*a.scale,t.y*a.scale),n=new o(t.width*a.scale,t.height*a.scale),s=e.name.match(/^player_start_(\d+\.\d+)$/);"collision"===e.name?a.playerClips.push(new I(i,n)):"portal"===e.name?a.portals.push(new pe(i,n,e)):"npcs"===e.name?a.npcs.push(new J(t,r)):"enemies"===e.name?a.enemies.push(new ae(t,r)):"config"===e.name?a.config=a.obj.properties:s&&(a.playerStarts[s[1]]=t)})})}var t,i,r;return t=e,(i=[{key:"update",value:function(e){var t=this,i=[];return this.playerClips.forEach(function(e){var i=t.player.collidesWith(e);i&&t.player.resetPos(i)}),this.portals.forEach(function(e){t.player.collidesWith(e)&&i.push({type:"enter_portal",obj:e})}),i}},{key:"draw",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.data.layers.forEach(function(n){if("tilelayer"===n.type&&(!i||"above_player"===n.name)&&(i||"above_player"!==n.name)){var r=0,o=0;n.data.forEach(function(i,a){t.renderable.frame=i-1,r=a%n.width,o=Math.floor(a/n.width),e.save(),e.translate(t.pos.x+r*t.renderable.subWidth*t.renderable.scale,t.pos.y+o*t.renderable.subHeight*t.renderable.scale),t.renderable.draw(e),e.restore()})}})}},{key:"destruct",value:function(){this.npcs.forEach(function(e){return _handler.unregister(e)})}}])&&ye(t.prototype,i),r&&ye(t,r),e}();function be(e){return function(e){if(Array.isArray(e)){for(var t=0,i=new Array(e.length);t<e.length;t++)i[t]=e[t];return i}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function ve(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var ge=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.inanimates=[],this.actors=[],this.dialogues=[],this.player=new A(new o(75,75),new o(36,64)),this.reload(t)}var t,i,r;return t=e,(i=[{key:"reload",value:function(e,t){this.map&&this.map.destruct(),this.map=new de(e,C.a,this.player);var i=t?this.map.playerStarts[t.portal_from]:this.map.playerStarts["0.0"];this.player.pos.x=i.x*n.scale,this.player.pos.y=i.y*n.scale}},{key:"update",value:function(e){var t=this;return this.entities.forEach(function(t){t.update(e)}),this.dialogues.forEach(function(e,i){e.done&&t.dialogues.splice(i,1)}),this.map.update(e)}},{key:"entities",get:function(){return[this.player].concat(be(this.inanimates),be(this.actors),be(this.dialogues),be(this.map.npcs),be(this.map.enemies))}}])&&ve(t.prototype,i),r&&ve(t,r),e}(),me=[[i(5),i(6),i(7)]];function we(e){return(we="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function xe(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ke(e,t){return!t||"object"!==we(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Oe(e){return(Oe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _e(e,t){return(_e=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var je=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);return ke(this,Oe(t).call(this,[{type:"start",description:"Press Enter to Start!",action:function(e){e.active=!1}},{type:"load",description:"Load Saved State (doesn't work yet)",action:function(e){}}]))}var i,n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_e(e,t)}(t,p),i=t,(n=[{key:"draw",value:function(e,t,i,n){var r=this;e.save(),e.translate(-n.x,-n.y),e.fillStyle="rgba(0, 0, 0, .85)",e.fillRect(0,0,t,i),e.fillStyle="#FFF",e.textAlign="center",this.menu.forEach(function(n,o){var a=r.menu[o],s=a===r.currentOption;s?(e.shadowColor="#FFF",e.shadowOffsetX=2,e.shadowOffsetY=2,e.shadowBlur=4,e.font="bold 42px Arial"):e.font="42px Arial",e.fillText(s?"▶ "+a.description:a.description,t/2,i/(r.menu.length-o)*.5)}),e.restore()}}])&&xe(i.prototype,n),r&&xe(i,r),t}();function Pe(e){return(Pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Se(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ee(e,t){return!t||"object"!==Pe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Te(e){return(Te=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ae(e,t){return(Ae=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Re=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];return Ee(this,Te(t).call(this,i))}var i,n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ae(e,t)}(t,p),i=t,(n=[{key:"draw",value:function(e,t,i){var n=this;e.save(),e.font="12px Arial",e.translate(t.x+i.pos.x-72*this.menu.length,t.y+i.pos.y+i.size.y+24),this.menu.forEach(function(t){var i=t===n.selected[0],r=i?64:24;e.translate(72,0),e.fillStyle="#fff",e.fillRect(0,0,64,r),e.fillStyle="#000",e.fillText(t.type,4,16),i&&t.menu&&t.menu.length&&t.menu.forEach(function(t,i){e.save(),n.currentOption===t?e.font="bold 12px Arial":e.font="12px Arial";var r=t.name?t.name:t;e.translate(0,18*(i+1)),e.fillText(r,4,16),e.restore()})}),e.restore()}},{key:"register",value:function(){var e=this;return{keyup:function(t){switch(t.key){case"ArrowDown":e.select();break;case"ArrowUp":e.back();break;case"ArrowLeft":e.previousOption();break;case"ArrowRight":e.nextOption()}}}}}])&&Se(i.prototype,n),r&&Se(i,r),t}();function Ce(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var De=function(){function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.active=!0,this.player=t,this.enemy=i,this.origPlayerPos=t.lastPos.copy(),this.origEnemyPos=i.lastPos.copy(),this.player.pos.x=64,this.player.pos.y=128,this.player.direction=4,this.enemy.pos.x=320,this.enemy.pos.y=0,this.enemy.direction=2,this.player.lock(),this.enemy.lock(),this.playersTurn=this.player.stats.spd<this.enemy.stats.spd,this.cycle(),this.battleMenu=this.battleMenu()}var t,i,n;return t=e,(i=[{key:"cycle",value:function(){this.playersTurn=!this.playersTurn}},{key:"battleMenu",value:function(){return new Re({type:"Items",menu:[]},{type:"Attack",menu:[this.player.weapon]},{type:"Spells",menu:[this.player.spells]},{type:"Other",menu:["Defend","Run Away"]})}},{key:"update",value:function(e){}},{key:"draw",value:function(e,t,i){var n=new o(t/2-128-64,i/2-64-64);e.save(),e.fillStyle="#ccc",e.fillRect(0,0,t,i),e.fillStyle="#FFF",e.textAlign="center",e.restore(),e.save(),e.translate(n.x,n.y),this.player.draw(e),this.enemy.draw(e),e.restore(),this.drawUiBar(e),this.drawEnemyUiBar(e,t,i),this.playersTurn&&this.battleMenu.draw(e,n,this.player)}},{key:"drawUiBar",value:function(e){e.save(),e.fillStyle="#000",e.fillRect(0,0,512,48),e.fillStyle="#FFF",e.font="20px Arial",e.fillText("HP : "+this.player.stats.hp,16,32),e.restore()}},{key:"drawEnemyUiBar",value:function(e,t,i){e.save(),e.translate(t-512,0),e.fillStyle="#000",e.fillRect(0,0,512,48),e.fillStyle="#FFF",e.font="20px Arial",e.fillText("HP : "+this.enemy.stats.hp,16,32),e.restore()}}])&&Ce(t.prototype,i),n&&Ce(t,n),e}();function Fe(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var ze=function(){function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.resolution=new o(t,i),this.resize(t,i),this.levelNumber=0,this.offset=new o(0,0),this.battle=null,this.state="start-menu",this.states=["start-menu","play","pause","inventory","battle"],this.menu=new je,_handler.register(this)}var t,i,n;return t=e,(i=[{key:"loadLevel",value:function(e){var t=e.obj.portal_to.match(/^(\d+)\.(\d+)$/),i=me[parseInt(t[1])][parseInt(t[2])],n=e.obj;this.level.reload(i,n)}},{key:"start",value:function(){this.level=new ge(me[0][0])}},{key:"update",value:function(e){var t=this;if(this.menu.active?this.lock("start-menu"):this.level.player.inventory.active?this.lock("inventory"):this.battle&&this.battle.active?this.battle.update(e):this.unlock(),"playing"===this.state){var i=this.level.update(e);i.length&&i.forEach(function(e){(e.type="enter_portal")&&t.loadLevel(e)}),this.battle&&this.battle.active?(this.offset.x=0,this.offset.y=0):(this.offset.x=this.width/2-this.level.player.pos.x,this.offset.y=this.height/2-this.level.player.pos.y)}}},{key:"resize",value:function(e,t){this.width=e,this.height=t}},{key:"lock",value:function(e){this.state=e,this.level.player.lock()}},{key:"unlock",value:function(){this.level.player.unlock(),this.state="playing"}},{key:"register",value:function(){var e=this;return{battle:function(t){e.battle||(e.battle=new De(t.detail.player,t.detail.enemy))}}}}])&&Fe(t.prototype,i),n&&Fe(t,n),e}();function We(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Me=function(){function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.game=i,this.ctx=t.getContext("2d"),this.buffer=document.createElement("canvas").getContext("2d"),this.triggerResize(this.game.width,this.game.height),_handler.register(this)}var t,i,n;return t=e,(i=[{key:"draw",value:function(e){var t=this;this.buffer.clearRect(0,0,this.game.width,this.game.height),this.buffer.save(),this.buffer.translate(e.x,e.y),this.buffer.fillRect(0,0,this.game.width,this.game.height),this.game.level.map.draw(this.buffer),this.game.level.entities.forEach(function(i){i.draw(t.buffer,e)}),this.game.level.map.draw(this.buffer,!0),this.game.level.player.inventory.active&&this.game.level.player.inventory.draw(this.buffer,this.game.width,this.game.height,e),this.game.battle&&this.game.battle.active&&this.game.battle.draw(this.buffer,this.game.width,this.game.height),this.game.menu.active&&this.game.menu.draw(this.buffer,this.game.width,this.game.height,e),this.buffer.restore(),this.ctx.clearRect(0,0,this.game.width,this.game.height),this.ctx.drawImage(this.buffer.canvas,0,0,this.buffer.canvas.width,this.buffer.canvas.height,0,0,this.ctx.canvas.width,this.ctx.canvas.height)}},{key:"triggerResize",value:function(){if(window.innerWidth<this.game.resolution.x){var e=this.game.height/this.game.width,t=Math.floor(window.innerWidth),i=Math.floor(window.innerWidth*e);t%2==1&&t--,i%2==1&&i--,this.resize(t,i)}else this.width!==this.game.resolution.x&&this.resize(this.game.resolution.x,this.game.resolution.y)}},{key:"resize",value:function(e,t){this.ctx.canvas.width=e,this.ctx.canvas.height=t,this.ctx.imageSmoothingEnabled=!1,this.buffer.canvas.width=e,this.buffer.canvas.height=t,this.buffer.imageSmoothingEnabled=!1,this.game.resize(e,t)}},{key:"register",value:function(){var e=this;return{resize:function(t){return e.triggerResize()}}}}])&&We(t.prototype,i),n&&We(t,n),e}();function Be(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Le=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.events={},this.customEvents={}}var t,i,n;return t=e,(i=[{key:"register",value:function(e){var t=this;if("function"!=typeof e.register)throw new Error("Target class does not have event register method");var i=e.register();Array.isArray(i)?i.forEach(function(i){return t.install(e,i)}):this.install(e,i)}},{key:"install",value:function(e,t){var i=this,n=function(n){i.events.hasOwnProperty(n)||(i.events[n]=[],window.addEventListener(n,function(e){i.events[n].forEach(function(t){t.handle(e,i)})})),i.events[n].push({target:e,handle:t[n]})};for(var r in t)n(r)}},{key:"unregister",value:function(e){for(var t in this.events)this.events[t]=this.events[t].filter(function(t){return t.target!==e})}},{key:"trigger",value:function(e,t){var i=new CustomEvent(e,{detail:t});window.dispatchEvent(i)}}])&&Be(t.prototype,i),n&&Be(t,n),e}();window._handler=new Le;var Ue=document.getElementById("game"),Ie=(Ue.getContext("2d"),new ze(1280,720)),He=new Me(Ue,Ie);Ie.start();var qe=0;requestAnimationFrame(function e(t){var i=t-qe;qe=t,Ie.update(i),He.draw(Ie.offset),requestAnimationFrame(e)})}]);