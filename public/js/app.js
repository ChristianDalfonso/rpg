!function(t){var e={};function i(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=8)}([function(t,e,i){t.exports=i.p+"public/img/player-new.png"},function(t,e,i){t.exports=i.p+"public/img/dungeon_sheet.png"},function(t){t.exports={murdoc:{display_name:"Murdoc",default:{speech:["You look lost.","What's that, you are lost?","Well, you're in The Desolate Cave.","Be careful. There are bandits running around here."]}}}},function(t){t.exports={knight:{display_name:"Knight",default:{stats:{hp:5,atk:2,def:0,sp_atk:0,sp_de:0,spd:0}}}}},function(t,e,i){t.exports=i.p+"public/img/knight.png"},function(t){t.exports={height:18,infinite:!1,layers:[{data:[55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,0,0,0,0,0,0,55,55,55,55,0,0,0,0,0,0,0,0,0,0,0,0,55,55,55,55,0,0,0,0,0,0],height:18,id:19,name:"floor",opacity:1,type:"tilelayer",visible:!0,width:16,x:0,y:0},{data:[6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,30,31,31,31,31,31,31,31,31,31,31,31,31,31,31,32,54,0,0,0,0,0,0,0,0,0,0,0,0,0,0,56,54,0,0,0,0,238,238,238,238,0,0,0,0,0,0,56,54,0,0,238,238,238,238,238,238,0,0,0,0,238,238,56,54,0,0,238,238,238,238,238,238,0,0,0,0,238,238,56,54,0,0,238,238,238,238,238,238,0,0,0,0,238,238,56,54,0,0,238,238,238,238,238,238,0,0,0,0,238,238,56,54,0,0,238,238,238,238,238,238,0,0,0,0,238,238,56,54,0,0,238,238,238,238,238,238,0,0,0,0,238,238,56,54,0,0,238,238,238,238,238,238,0,0,0,0,238,238,56,54,0,0,238,238,238,238,238,238,0,0,0,0,238,238,56,54,0,0,238,238,0,238,238,238,0,0,0,0,238,238,56,54,0,0,0,0,0,0,0,0,0,0,0,0,0,0,56,54,0,0,0,0,0,0,0,0,0,0,0,0,0,0,56,78,79,79,79,79,79,10,0,0,9,79,79,79,79,79,80,26,26,26,26,26,26,54,0,0,56,26,26,26,26,26,26,26,26,26,26,26,26,54,0,0,56,26,26,26,26,26,26],height:18,id:20,name:"walls",opacity:1,type:"tilelayer",visible:!0,width:16,x:0,y:0},{draworder:"topdown",id:10,name:"player_start_0.1",objects:[{height:20,id:46,name:"",rotation:0,type:"",visible:!0,width:8,x:124,y:260}],opacity:1,type:"objectgroup",visible:!0,x:0,y:0},{draworder:"topdown",id:11,name:"player_start_0.0",objects:[{height:32,id:44,name:"",rotation:0,type:"",visible:!0,width:12,x:122,y:112}],opacity:1,type:"objectgroup",visible:!0,x:0,y:0},{draworder:"topdown",id:12,name:"config",objects:[],opacity:1,properties:[{name:"level",type:"string",value:"0.0"}],type:"objectgroup",visible:!0,x:0,y:0},{draworder:"topdown",id:9,name:"portal",objects:[{height:8,id:29,name:"",rotation:0,type:"",visible:!0,width:40,x:108,y:280}],opacity:1,properties:[{name:"portal_from",type:"string",value:"0.0"},{name:"portal_to",type:"string",value:"0.1"}],type:"objectgroup",visible:!0,x:0,y:0},{draworder:"topdown",id:5,name:"collision",objects:[{height:32,id:47,name:"",rotation:0,type:"",visible:!0,width:255.636363636364,x:.363636363636364,y:0},{height:224,id:49,name:"",rotation:0,type:"",visible:!0,width:14,x:242,y:32},{height:224,id:50,name:"",rotation:0,type:"",visible:!0,width:16,x:0,y:32},{height:14,id:51,name:"",rotation:0,type:"",visible:!0,width:93,x:151,y:242},{height:14,id:52,name:"",rotation:0,type:"",visible:!0,width:93,x:12,y:242},{height:46,id:54,name:"",rotation:0,type:"",visible:!0,width:16,x:148,y:242},{height:46,id:55,name:"",rotation:0,type:"",visible:!0,width:16,x:92,y:242}],opacity:1,type:"objectgroup",visible:!0,x:0,y:0}],nextlayerid:21,nextobjectid:56,orientation:"orthogonal",renderorder:"right-down",tiledversion:"1.2.3",tileheight:16,tilesets:[{firstgid:1,source:"C:/Users/Anthony/Desktop/maps/dungeon_tiles.tsx"}],tilewidth:16,type:"map",version:1.2,width:16}},function(t){t.exports={height:20,infinite:!1,layers:[{data:[55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55],height:20,id:12,name:"floor",opacity:1,type:"tilelayer",visible:!0,width:32,x:0,y:0},{data:[6,7,7,7,7,7,7,7,7,7,7,7,8,26,26,26,26,26,54,0,56,26,26,26,26,26,26,26,26,26,26,26,30,31,31,31,31,31,31,31,31,31,31,31,32,26,26,26,6,7,58,0,57,7,7,7,7,7,7,7,7,7,7,8,54,0,213,0,0,0,0,213,0,0,0,0,56,26,26,26,30,31,82,0,81,31,31,31,31,31,31,31,31,31,31,32,54,213,213,213,213,19,20,213,0,0,0,0,56,26,26,26,54,0,0,0,0,0,0,0,0,0,0,0,0,0,0,56,54,213,213,213,213,43,44,213,0,0,0,0,56,26,26,26,54,0,0,0,0,0,0,0,0,9,79,79,79,10,0,56,54,213,213,213,213,67,68,213,0,0,0,0,56,26,26,26,54,0,0,0,0,0,0,0,0,56,26,26,26,54,0,56,54,213,213,213,213,0,0,213,0,0,0,0,56,26,26,26,54,0,0,0,0,0,0,0,0,56,26,26,26,54,0,56,54,0,213,213,213,19,20,0,0,0,0,0,56,26,26,26,54,0,0,0,0,0,0,0,0,56,26,26,26,54,0,56,54,0,213,213,213,43,44,0,0,0,0,0,56,26,26,26,78,79,79,79,79,79,79,79,79,80,26,26,26,54,0,56,54,0,0,0,0,67,68,0,0,0,0,0,57,7,7,7,7,7,7,7,7,7,7,7,7,106,7,7,7,58,0,56,54,0,0,0,0,0,0,0,0,0,0,0,81,31,31,31,31,31,31,31,31,31,31,31,31,129,31,31,31,82,0,56,54,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,56,78,79,79,79,10,0,0,9,79,79,79,79,79,79,79,10,0,9,79,79,79,79,79,79,79,79,79,79,79,79,79,80,26,26,26,26,54,0,0,56,26,26,26,26,26,26,26,54,0,56,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,54,0,0,56,26,26,26,26,26,26,26,54,0,57,7,7,7,7,7,7,7,7,7,7,7,7,7,8,26,26,26,26,54,0,0,56,26,26,26,26,26,26,26,54,0,81,31,31,31,31,31,31,31,31,31,31,31,31,31,32,26,26,26,26,54,0,0,56,26,26,26,26,26,26,26,54,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,56,26,26,26,26,54,0,0,56,26,26,26,26,26,26,26,78,79,79,79,79,79,79,79,79,79,79,10,0,0,189,0,56,26,26,26,26,54,0,0,56,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,54,0,0,0,0,56,26,26,26,26,54,0,0,56,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,78,79,79,79,79,80],height:20,id:13,name:"walls",opacity:1,type:"tilelayer",visible:!0,width:32,x:0,y:0},{draworder:"topdown",id:6,name:"player_start_0.0",objects:[{height:24,id:14,name:"",rotation:0,type:"",visible:!0,width:8,x:309,y:8}],opacity:1,type:"objectgroup",visible:!0,x:0,y:0},{draworder:"topdown",id:14,name:"npcs",objects:[{height:16,id:37,name:"",properties:[{name:"name",type:"string",value:"murdoc"}],rotation:0,type:"",visible:!0,width:16,x:464,y:272}],opacity:1,type:"objectgroup",visible:!0,x:0,y:0},{draworder:"topdown",id:15,name:"enemies",objects:[{height:20,id:38,name:"",properties:[{name:"type",type:"string",value:"knight"}],rotation:0,type:"",visible:!0,width:10,x:288,y:64}],opacity:1,type:"objectgroup",visible:!0,x:0,y:0},{draworder:"topdown",id:8,name:"player_start_0.2",objects:[{height:24,id:16,name:"",rotation:0,type:"",visible:!0,width:8,x:92,y:288}],opacity:1,type:"objectgroup",visible:!0,x:0,y:0},{draworder:"topdown",id:7,name:"config",objects:[],opacity:1,properties:[{name:"level",type:"string",value:"0.1"}],type:"objectgroup",visible:!0,x:0,y:0},{draworder:"topdown",id:3,name:"collision",objects:[{height:126,id:19,name:"",rotation:0,type:"",visible:!0,width:80,x:0,y:194},{height:126,id:22,name:"",rotation:0,type:"",visible:!0,width:144,x:112,y:194},{height:62,id:23,name:"",rotation:0,type:"",visible:!0,width:240,x:272,y:194},{height:46,id:24,name:"",rotation:0,type:"",visible:!0,width:176,x:256,y:274},{height:64,id:25,name:"",rotation:0,type:"",visible:!0,width:13,x:499,y:256},{height:14,id:26,name:"",rotation:0,type:"",visible:!0,width:67,x:432,y:306},{height:138,id:27,name:"",rotation:0,type:"",visible:!0,width:73,x:196,y:0},{height:46,id:28,name:"",rotation:0,type:"",visible:!0,width:281,x:196,y:130},{height:66,id:29,name:"",rotation:0,type:"",visible:!0,width:73,x:404,y:64},{height:48,id:30,name:"",rotation:0,type:"",visible:!0,width:188,x:324,y:0},{height:146,id:31,name:"",rotation:0,type:"",visible:!0,width:11,x:501,y:48},{height:32,id:32,name:"",rotation:0,type:"",visible:!0,width:196,x:0,y:0},{height:162,id:33,name:"",rotation:0,type:"",visible:!0,width:13,x:0,y:32},{height:40,id:34,name:"",rotation:0,type:"",visible:!0,width:26,x:83,y:51},{height:40,id:35,name:"",rotation:0,type:"",visible:!0,width:26,x:83,y:115},{height:48,id:36,name:"",rotation:0,type:"",visible:!0,width:33,x:269,y:0}],opacity:1,type:"objectgroup",visible:!0,x:0,y:0},{draworder:"topdown",id:5,name:"portal",objects:[{height:8,id:11,name:"",properties:[{name:"portal_to",type:"string",value:"1.0"}],rotation:0,type:"",visible:!0,width:22,x:302,y:0}],opacity:1,properties:[{name:"portal_from",type:"string",value:"0.1"},{name:"portal_to",type:"string",value:"0.0"}],type:"objectgroup",visible:!0,x:0,y:0},{draworder:"topdown",id:9,name:"portal",objects:[{height:8,id:18,name:"",properties:[{name:"portal_to",type:"string",value:"1.0"}],rotation:0,type:"",visible:!0,width:32,x:80,y:312}],opacity:1,properties:[{name:"portal_from",type:"string",value:"0.1"},{name:"portal_to",type:"string",value:"0.2"}],type:"objectgroup",visible:!0,x:0,y:0}],nextlayerid:16,nextobjectid:39,orientation:"orthogonal",renderorder:"right-down",tiledversion:"1.2.3",tileheight:16,tilesets:[{firstgid:1,source:"C:/Users/Anthony/Desktop/maps/dungeon_tiles.tsx"}],tilewidth:16,type:"map",version:1.2,width:32}},function(t){t.exports={height:16,infinite:!1,layers:[{data:[55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55],height:16,id:3,name:"floor",opacity:1,type:"tilelayer",visible:!0,width:24,x:0,y:0},{data:[6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,30,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,32,54,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,56,54,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,56,54,0,0,0,9,79,79,79,79,79,10,0,0,9,79,79,79,79,79,79,10,0,0,56,0,0,0,0,56,6,7,7,7,7,58,0,0,57,7,7,7,7,7,8,54,0,0,56,0,0,0,0,56,30,31,31,31,31,82,0,0,81,31,31,31,31,31,32,54,0,0,56,54,0,0,0,56,54,0,0,0,0,0,0,0,0,0,0,0,0,0,56,54,0,0,56,54,0,0,0,56,54,0,0,0,0,0,0,0,0,0,0,0,0,0,56,54,0,0,56,54,0,0,0,56,54,0,0,0,0,0,0,0,0,0,0,0,0,0,56,54,0,0,56,54,0,0,0,56,78,79,79,79,79,79,79,79,79,79,79,79,79,79,80,54,0,0,56,54,0,0,0,57,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,58,0,0,56,54,0,0,0,81,31,169,31,169,31,169,31,169,31,169,31,169,31,169,31,82,0,0,56,54,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,56,54,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,56,78,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,80],height:16,id:4,name:"walls",opacity:1,type:"tilelayer",visible:!0,width:24,x:0,y:0},{draworder:"topdown",id:5,name:"collision",objects:[{height:32,id:1,name:"",rotation:0,type:"",visible:!0,width:384,x:0,y:0},{height:96,id:2,name:"",rotation:0,type:"",visible:!0,width:0,x:384,y:16},{height:224,id:4,name:"",rotation:0,type:"",visible:!0,width:16,x:368,y:32},{height:144,id:5,name:"",rotation:0,type:"",visible:!0,width:16,x:0,y:112},{height:48,id:6,name:"",rotation:0,type:"",visible:!0,width:16,x:0,y:32},{height:48,id:9,name:"",rotation:0,type:"",visible:!0,width:32,x:64,y:112},{height:48,id:10,name:"",rotation:0,type:"",visible:!0,width:32,x:304,y:112},{height:37,id:12,name:"",rotation:0,type:"",visible:!0,width:128,x:208,y:75.25},{height:37,id:13,name:"",rotation:0,type:"",visible:!0,width:112,x:64,y:75},{height:48,id:14,name:"",rotation:0,type:"",visible:!0,width:272,x:64,y:160},{height:16,id:16,name:"",rotation:0,type:"",visible:!0,width:352,x:16,y:240}],opacity:1,type:"objectgroup",visible:!0,x:0,y:0},{draworder:"topdown",id:6,name:"portal",objects:[{height:32,id:18,name:"",properties:[{name:"portal_from",type:"string",value:"0.2"},{name:"portal_to",type:"string",value:"0.1"}],rotation:0,type:"",visible:!0,width:8,x:0,y:80}],opacity:1,properties:[{name:"portal_from",type:"string",value:"0.2"},{name:"portal_to",type:"string",value:"0.1"}],type:"objectgroup",visible:!0,x:0,y:0},{draworder:"topdown",id:7,name:"player_start_0.1",objects:[{height:32,id:19,name:"",rotation:0,type:"",visible:!0,width:8,x:8,y:80}],opacity:1,type:"objectgroup",visible:!0,x:0,y:0}],nextlayerid:8,nextobjectid:20,orientation:"orthogonal",renderorder:"right-down",tiledversion:"1.2.3",tileheight:16,tilesets:[{firstgid:1,source:"C:/Users/Anthony/Desktop/maps/dungeon_tiles.tsx"}],tilewidth:16,type:"map",version:1.2,width:24}},function(t,e,i){i(10),t.exports=i(9)},function(t,e,i){},function(t,i,n){"use strict";n.r(i);var r={debug:!1,scale:3};function o(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var a=function(){function t(e,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.x=e,this.y=i}var e,i,n;return e=t,(i=[{key:"copy",value:function(){return new t(this.x,this.y)}},{key:"times",value:function(e){return new t(this.x*e,this.y*e)}}])&&o(e.prototype,i),n&&o(e,n),t}();function s(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var l=function(){function t(e,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.pos=e.times(r.scale),this.size=i,this.inDialogue,this.locked=!1,this.lastPos=e.copy()}var e,i,n;return e=t,(i=[{key:"update",value:function(t){}},{key:"collidesWith",value:function(t){var e=this.collisionPoint();return!!(e.x>t.pos.x&&e.x<t.pos.x+t.size.x&&e.y>t.pos.y&&e.y<t.pos.y+t.size.y)&&{pos:t.pos.copy(),size:t.size.copy()}}},{key:"collisionPoint",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return new a((t?this.lastPos.x:this.pos.x)+.5*this.size.x,(t?this.lastPos.y:this.pos.y)+.8*this.size.y)}},{key:"draw",value:function(t){r.debug&&this.debugDraw(t),this.lastPos.x=this.pos.x,this.lastPos.y=this.pos.y}},{key:"debugDraw",value:function(t){t.fillStyle="#F99",t.fillRect(this.pos.x,this.pos.y,this.size.x,this.size.y)}},{key:"resetPos",value:function(t){var e=this.collisionPoint(!0);t?e.x<t.pos.x||e.x>t.pos.x+t.size.x?this.pos.x=this.lastPos.x:this.pos.y=this.lastPos.y:(this.pos.x=this.lastPos.x,this.pos.y=this.lastPos.y)}},{key:"lock",value:function(){this.locked=!0}},{key:"unlock",value:function(){this.inDialogue||(this.locked=!1)}}])&&s(e.prototype,i),n&&s(e,n),t}(),u=n(0),c=n.n(u);function h(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var p=function(){function t(e){var i=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:9,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:9,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:4,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.img=new Image,this.img.src=e,this.scale=n,this.frame=r,this.startFrame=r,this.frameCount=o,this.framesX=a,this.framesY=s,this.speed=l,this.animTime=(new Date).getTime(),this.img.onload=function(){i.subWidth=i.img.width/i.framesX,i.subHeight=i.img.height/i.framesY}}var e,i,n;return e=t,(i=[{key:"draw",value:function(t){var e=(new Date).getTime();e>=this.animTime&&(this.frame++,this.animTime=e+1e3/this.speed),this.frame>this.startFrame+this.frameCount&&(this.frame=this.startFrame);var i=this.frame%this.framesX*this.subWidth,n=Math.floor(this.frame/this.framesX)*this.subHeight;t.drawImage(this.img,i,n,this.subWidth,this.subHeight,0,0,this.subWidth*this.scale,this.subHeight*this.scale)}}])&&h(e.prototype,i),n&&h(e,n),t}();function f(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var y=function(){function t(e){for(var i in function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e)this["base_"+i]=e[i];this.lvl=1,this.experience=0,this.damage=0}var i,n,r;return i=t,(n=[{key:"hp",get:function(){return this.base_hp-this.damage}},{key:"atk",get:function(){return this.base_atk}},{key:"def",get:function(){return this.base_def}},{key:"sp_atk",get:function(){return this.base_sp_atk-e}},{key:"sp_def",get:function(){return this.base_sp_def}},{key:"givesExperience",get:function(){return this.base_hp+this.base_atk+this.base_def+this.base_sp_atk+this.base_sp_def+this.base_spd}}])&&f(i.prototype,n),r&&f(i,r),t}();function d(t){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function b(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function v(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function g(t,e,i){return(g="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,i){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=w(t)););return t}(t,e);if(n){var r=Object.getOwnPropertyDescriptor(n,e);return r.get?r.get.call(i):r.value}})(t,e,i||t)}function w(t){return(w=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function m(t,e){return(m=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var x=function(t){function e(t,i){var n,r,o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=this,(n=!(o=w(e).call(this,t,i))||"object"!==d(o)&&"function"!=typeof o?v(r):o).speed=new a(0,0),n.maxSpeed=i.x/10,n.direction=0,n.sprites=[new p(c.a,2,0,0,1,4,8),new p(c.a,2,3,0,1,4,8),new p(c.a,2,2,0,1,4,8),new p(c.a,2,0,0,1,4,8),new p(c.a,2,1,0,1,4,8)],n.stats=new y({hp:10,atk:2,def:0,sp_atk:0,sp_def:0,spd:1}),n.weapon=null,n.spells=[],_handler.register(v(n)),n}var i,n,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&m(t,e)}(e,l),i=e,(n=[{key:"update",value:function(t){this.locked||(this.pos.x+=this.speed.x,this.pos.y+=this.speed.y,g(w(e.prototype),"update",this).call(this))}},{key:"draw",value:function(t){g(w(e.prototype),"draw",this).call(this,t),t.save(),t.translate(this.pos.x,this.pos.y),this.sprites[this.direction].draw(t),t.restore()}},{key:"move",value:function(t){switch(t){case"ArrowLeft":this.speed.x=-this.maxSpeed;break;case"ArrowDown":this.speed.y=this.maxSpeed;break;case"ArrowRight":this.speed.x=this.maxSpeed;break;case"ArrowUp":this.speed.y=-this.maxSpeed}this.changeDirection()}},{key:"stop",value:function(t){"ArrowLeft"===t&&this.speed.x<0&&(this.speed.x=0),"ArrowRight"===t&&this.speed.x>0&&(this.speed.x=0),"ArrowUp"===t&&this.speed.y<0&&(this.speed.y=0),"ArrowDown"===t&&this.speed.y>0&&(this.speed.y=0),this.changeDirection()}},{key:"changeDirection",value:function(){this.locked||(this.speed.x>0?this.direction=4:this.speed.x<0?this.direction=2:this.speed.y>0?this.direction=3:this.speed.y<0&&(this.direction=1))}},{key:"register",value:function(){var t=this;return{keydown:function(e){e.key.match(/Arrow/)&&t.move(e.key)},keyup:function(e){e.key.match(/Arrow/)&&t.stop(e.key)}}}},{key:"name",get:function(){return"player"}},{key:"dialogueName",get:function(){return"Me"}}])&&b(i.prototype,n),r&&b(i,r),e}(),k=n(1),_=n.n(k);function O(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var j=function(){function t(e,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.pos=e||new a(0,0),this.size=i||new a(0,0)}var e,i,n;return e=t,(i=[{key:"update",value:function(t,e){}},{key:"draw",value:function(t){r.debug&&(t.strokeStyle="#F00",t.strokeRect(this.pos.x,this.pos.y,this.size.x,this.size.y))}}])&&O(e.prototype,i),n&&O(e,n),t}();function P(t){return(P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function S(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function E(t,e){return!e||"object"!==P(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function T(t,e,i){return(T="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,i){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=A(t)););return t}(t,e);if(n){var r=Object.getOwnPropertyDescriptor(n,e);return r.get?r.get.call(i):r.value}})(t,e,i||t)}function A(t){return(A=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function R(t,e){return(R=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var C=function(t){function e(t,i){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),E(this,A(e).call(this,t,i))}var i,n,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&R(t,e)}(e,j),i=e,(n=[{key:"draw",value:function(t){T(A(e.prototype),"draw",this).call(this,t)}}])&&S(i.prototype,n),r&&S(i,r),e}(),I=n(2);function D(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var F=function(){function t(e,i){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.texts=e,this.entity=i,this.player=n,this.currentText="",this.index=0,this.waiting=!1,this.done=!1,this.frameLength=1e3/24,this.timeStore=0,this.entity.lock(),this.entity.inDialogue=!0,this.player.lock(),this.player.inDialogue=!0,_handler.register(this)}var e,i,n;return e=t,(i=[{key:"update",value:function(t){if(!this.waiting){for(this.timeStore+=t;this.timeStore>this.frameLength;)this.currentText=this.texts[this.index].substring(0,this.currentText.length+1),this.timeStore-=this.frameLength;return this.currentText===this.texts[this.index]?this.waiting=!0:void 0}}},{key:"draw",value:function(t,e){t.save(),t.translate(32-e.x,48-e.y),t.font="30px Arial",t.fillStyle="#FFF",t.fillText(this.entity.dialogueName+": "+this.currentText,0,0),t.restore()}},{key:"register",value:function(){var t=this;return{keyup:function(e,i){"Enter"===e.key&&t.next(),t.done&&i.unregister(t)}}}},{key:"next",value:function(t){this.waiting&&!this.done&&(this.index+1<this.texts.length?(this.index++,this.timeStore=0,this.currentText="",this.waiting=!1):(this.done=!0,this.entity.inDialogue=!1,this.entity.unlock(),this.player.inDialogue=!1,this.player.unlock()))}}])&&D(e.prototype,i),n&&D(e,n),t}();function z(t){return(z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function W(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function M(t){return(M=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function B(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function L(t,e){return(L=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var U=function(t){function e(t,i){var n,r,o;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=this,n=!(o=M(e).call(this,new a(t.x,t.y),new a(t.width,t.height)))||"object"!==z(o)&&"function"!=typeof o?B(r):o;var s=t.properties.filter(function(t){return"name"===t.name})[0].value,l=I[s];if(!l)throw new Error("NPC data for "+s+" is not defined in npcs.json");return n.name=s,n.npc=l,n.dialogue=null,n.playerRef=i,_handler.register(B(n)),n}var i,n,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&L(t,e)}(e,l),i=e,(n=[{key:"speak",value:function(){!this.dialogue&&this.collidesWith(this.playerRef)&&(this.dialogue=new F(this.npc.default.speech,this,this.playerRef))}},{key:"update",value:function(t,e){this.dialogue&&this.dialogue.done?this.dialogue=null:this.dialogue&&this.dialogue.update(t)}},{key:"draw",value:function(t,e){this.dialogue&&this.dialogue.draw(t,e)}},{key:"register",value:function(){var t=this;return{keyup:function(e){" "!==e.key&&"Enter"!==e.key||t.speak()}}}},{key:"dialogueName",get:function(){return this.npc.display_name}}])&&W(i.prototype,n),r&&W(i,r),e}(),q=n(3),H=n(4);function X(t){return(X="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function N(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Y(t,e){return!e||"object"!==X(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function $(t,e,i){return($="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,i){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=K(t)););return t}(t,e);if(n){var r=Object.getOwnPropertyDescriptor(n,e);return r.get?r.get.call(i):r.value}})(t,e,i||t)}function K(t){return(K=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function G(t,e){return(G=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var J={knight:n.n(H).a},Q=function(t){function e(t,i){var n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=Y(this,K(e).call(this,new a(t.x,t.y),new a(t.width,t.height)));var r=t.properties.filter(function(t){return"type"===t.name})[0].value,o=q[r];if(!o)throw new Error("Enemy data for "+name+" is not defined in enemies.json");n.type=r,n.data=o,n.dialogue=null,n.playerRef=i,n.stats=new y(o.default.stats);var s=J[n.type];return n.sprites=[new p(s,2,0,0,1,4,8),new p(s,2,3,0,1,4,8),new p(s,2,2,0,1,4,8),new p(s,2,0,0,1,4,8),new p(s,2,1,0,1,4,8)],n.direction=4,n}var i,n,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&G(t,e)}(e,l),i=e,(n=[{key:"fight",value:function(t){_handler.trigger("battle",{player:this.playerRef,enemy:this})}},{key:"update",value:function(t,e){this.collidesWith(this.playerRef)&&this.fight(this.playerRef)}},{key:"draw",value:function(t){$(K(e.prototype),"draw",this).call(this,t),t.save(),t.translate(this.pos.x,this.pos.y),this.sprites[this.direction].draw(t),t.restore()}},{key:"dialogueName",get:function(){return this.data.display_name}}])&&N(i.prototype,n),r&&N(i,r),e}();function V(t){return(V="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Z(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function tt(t,e){return!e||"object"!==V(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function et(t,e,i){return(et="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,i){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=it(t)););return t}(t,e);if(n){var r=Object.getOwnPropertyDescriptor(n,e);return r.get?r.get.call(i):r.value}})(t,e,i||t)}function it(t){return(it=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function nt(t,e){return(nt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var rt=function(t){function e(t,i,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=tt(this,it(e).call(this,t,i)),n&&n.properties&&n.properties.forEach(function(t){r[t.name]=t.value}),r}var i,n,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&nt(t,e)}(e,j),i=e,(n=[{key:"draw",value:function(t){et(it(e.prototype),"draw",this).call(this,t)}}])&&Z(i.prototype,n),r&&Z(i,r),e}();function ot(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var at=function(){function t(e,i,n){var o=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.data=e,this.player=n,this.pos={x:0,y:0},this.scale=r.scale,this.config={},this.renderable=new p(i,this.scale,0,240,24,10,0),this.playerClips=[],this.portals=[],this.npcs=[],this.enemies=[],this.playerStarts={},this.data.layers.forEach(function(t){"objectgroup"===t.type&&t.objects.forEach(function(e){var i=new a(e.x*o.scale,e.y*o.scale),r=new a(e.width*o.scale,e.height*o.scale),s=t.name.match(/^player_start_(\d+\.\d+)$/);"collision"===t.name?o.playerClips.push(new C(i,r)):"portal"===t.name?o.portals.push(new rt(i,r,t)):"npcs"===t.name?o.npcs.push(new U(e,n)):"enemies"===t.name?o.enemies.push(new Q(e,n)):"config"===t.name?o.config=o.obj.properties:s&&(o.playerStarts[s[1]]=e)})})}var e,i,n;return e=t,(i=[{key:"update",value:function(t){var e=this,i=[];return this.playerClips.forEach(function(t){var i=e.player.collidesWith(t);i&&e.player.resetPos(i)}),this.portals.forEach(function(t){e.player.collidesWith(t)&&i.push({type:"enter_portal",obj:t})}),i}},{key:"draw",value:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.data.layers.forEach(function(n){if("tilelayer"===n.type&&(!i||"above_player"===n.name)&&(i||"above_player"!==n.name)){var r=0,o=0;n.data.forEach(function(i,a){e.renderable.frame=i-1,r=a%n.width,o=Math.floor(a/n.width),t.save(),t.translate(e.pos.x+r*e.renderable.subWidth*e.renderable.scale,e.pos.y+o*e.renderable.subHeight*e.renderable.scale),e.renderable.draw(t),t.restore()})}})}},{key:"destruct",value:function(){this.npcs.forEach(function(t){return _handler.unregister(t)})}}])&&ot(e.prototype,i),n&&ot(e,n),t}();function st(t){return function(t){if(Array.isArray(t)){for(var e=0,i=new Array(t.length);e<t.length;e++)i[e]=t[e];return i}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function lt(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var ut=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.inanimates=[],this.actors=[],this.dialogues=[],this.player=new x(new a(75,75),new a(36,64)),this.reload(e)}var e,i,n;return e=t,(i=[{key:"reload",value:function(t,e){this.map&&this.map.destruct(),this.map=new at(t,_.a,this.player);var i=e?this.map.playerStarts[e.portal_from]:this.map.playerStarts["0.0"];this.player.pos.x=i.x*r.scale,this.player.pos.y=i.y*r.scale}},{key:"update",value:function(t){var e=this;return this.entities.forEach(function(e){e.update(t)}),this.dialogues.forEach(function(t,i){t.done&&e.dialogues.splice(i,1)}),this.map.update(t)}},{key:"entities",get:function(){return[this.player].concat(st(this.inanimates),st(this.actors),st(this.dialogues),st(this.map.npcs),st(this.map.enemies))}}])&&lt(e.prototype,i),n&&lt(e,n),t}(),ct=[[n(5),n(6),n(7)]];function ht(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var pt=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.options=e,this.index=0,this.subIndex=null,this.active=!0,_handler.register(this)}var e,i,n;return e=t,(i=[{key:"select",value:function(){var t=null===this.subIndex?this.options[this.index]:this.options[this.index].data[this.subIndex];null===this.subIndex&&t.type&&this[t.type]&&this[t.type].length?this.subIndex=0:null!==this.subIndex||t.hasOwnProperty("action")&&t.action(this)}},{key:"back",value:function(){null!==this.subIndex?this.subIndex=null:this.active=!1}},{key:"previousOption",value:function(){null===this.subIndex?0===this.index?this.index=this.options.length-1:this.index--:0===this.subIndex?this.subIndex=this[this.options[this.index].type].length-1:this.subIndex--}},{key:"nextOption",value:function(){null===this.subIndex?this.index===this.options.length-1?this.index=0:this.index++:this.subIndex===this[this.options[this.index].type].length-1?this.subIndex=0:this.subIndex++}},{key:"draw",value:function(t,e,i,n){}},{key:"register",value:function(){var t=this;return{keyup:function(e){if(t.active)switch(e.key){case"ArrowRight":case"Enter":t.select();break;case"ArrowLeft":case"Backspace":t.back();break;case"ArrowUp":t.previousOption();break;case"ArrowDown":t.nextOption()}}}}}])&&ht(e.prototype,i),n&&ht(e,n),t}();function ft(t){return(ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function yt(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function dt(t,e){return!e||"object"!==ft(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function bt(t){return(bt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function vt(t,e){return(vt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var gt=function(t){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);return dt(this,bt(e).call(this,[{type:"start",description:"Press Enter to Start!",action:function(t){t.active=!1}},{type:"load",description:"Load Saved State (doesn't work yet)",action:function(t){}}]))}var i,n,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&vt(t,e)}(e,pt),i=e,(n=[{key:"draw",value:function(t,e,i,n){var r=this;t.save(),t.translate(-n.x,-n.y),t.fillStyle="rgba(0, 0, 0, .85)",t.fillRect(0,0,e,i),t.fillStyle="#FFF",t.textAlign="center",this.options.forEach(function(n,o){var a=r.options[o];o===r.index?(t.shadowColor="#FFF",t.shadowOffsetX=2,t.shadowOffsetY=2,t.shadowBlur=4,t.font="bold 42px Arial"):t.font="42px Arial",t.fillText(o===r.index?"▶ "+a.description:a.description,e/2,i/(r.options.length-o)*.5)}),t.restore()}}])&&yt(i.prototype,n),r&&yt(i,r),e}();function wt(t){return(wt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function mt(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function xt(t,e){return!e||"object"!==wt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function kt(t,e,i){return(kt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,i){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=_t(t)););return t}(t,e);if(n){var r=Object.getOwnPropertyDescriptor(n,e);return r.get?r.get.call(i):r.value}})(t,e,i||t)}function _t(t){return(_t=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ot(t,e){return(Ot=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var jt=function(t){function e(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);return(t=xt(this,_t(e).call(this,[{type:"item",description:"Items",data:[]},{type:"equipable",description:"Equipment",data:[]},{type:"special",description:"Special",data:[]}]))).active=!1,t.items=[],t.equipable=[],t.special=[],t.equiped={weapon:null,armor:null,spell:null},t}var i,n,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ot(t,e)}(e,pt),i=e,(n=[{key:"store",value:function(t){this[t.type].push(t)}},{key:"draw",value:function(t,e,i,n){var r=this;t.save(),t.translate(-n.x,-n.y),t.fillStyle="rgba(200, 200, 200, .96)",t.fillRect(0,0,e,i),t.fillStyle="#75A",t.textAlign="left",this.options.forEach(function(e,i){t.save(),i===r.index&&null===r.subIndex?(t.shadowColor="#75A",t.shadowOffsetX=2,t.shadowOffsetY=2,t.shadowBlur=4,t.font="bold 24px Arial"):t.font="24px Arial",t.fillText(e.description,48,72*(i+1)),t.restore()});var o=this[this.options[this.index].type];o&&o.forEach(function(e,i){t.save(),i===r.subIndex?(t.shadowColor="#75A",t.shadowOffsetX=2,t.shadowOffsetY=2,t.shadowBlur=4,t.font="bold 20px Arial"):t.font="20px Arial",t.fillText(e.name,256,72*(r.index+1)+32*i),t.restore(),null!==r.subIndex&&i===r.subIndex&&(t.font="20px Arial",t.fillText(e.name+"\nDescription: "+e.description,512,72*(r.index+1)))}),t.restore()}},{key:"register",value:function(){var t=this;return[kt(_t(e.prototype),"register",this).call(this),{keyup:function(e){"i"===e.key&&(t.active=!t.active)}}]}}])&&mt(i.prototype,n),r&&mt(i,r),e}();var Pt=function t(e){for(var i in function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e)this[i]=e[i];this.type="equipable"};function St(t){return(St="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Et(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Tt(t,e){return!e||"object"!==St(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function At(t){return(At=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Rt(t,e){return(Rt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ct=function(t){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);for(var t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];return Tt(this,At(e).call(this,i))}var i,n,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Rt(t,e)}(e,pt),i=e,(n=[{key:"draw",value:function(t,e,i){var n=this;t.save(),t.font="12px Arial",t.translate(e.x+i.pos.x-72*this.options.length,e.y+i.pos.y+i.size.y+24),this.options.forEach(function(e){var i=e===n.options[n.index]?64:24;t.translate(72,0),t.fillStyle="#fff",t.fillRect(0,0,64,i),t.fillStyle="#000",t.fillText(e.type,4,16)}),t.restore()}},{key:"register",value:function(){var t=this;return{keyup:function(e){switch(e.key){case"ArrowDown":t.select();break;case"ArrowUp":t.back();break;case"ArrowLeft":t.previousOption();break;case"ArrowRight":t.nextOption()}}}}}])&&Et(i.prototype,n),r&&Et(i,r),e}();function It(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var Dt=function(){function t(e,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.active=!0,this.player=e,this.enemy=i,this.origPlayerPos=e.lastPos.copy(),this.origEnemyPos=i.lastPos.copy(),this.player.pos.x=64,this.player.pos.y=128,this.player.direction=4,this.enemy.pos.x=320,this.enemy.pos.y=0,this.enemy.direction=2,this.player.lock(),this.enemy.lock(),this.playersTurn=this.player.stats.spd<this.enemy.stats.spd,this.cycle(),this.battleMenu=this.battleMenu()}var e,i,n;return e=t,(i=[{key:"cycle",value:function(){this.playersTurn=!this.playersTurn}},{key:"battleMenu",value:function(){return new Ct({type:"Items",options:[]},{type:"Attack",options:[this.player.weapon]},{type:"Spells",options:[this.player.spells]},{type:"Other",options:["Defend","Run Away"]})}},{key:"update",value:function(t){}},{key:"draw",value:function(t,e,i){var n=new a(e/2-128-64,i/2-64-64);t.save(),t.fillStyle="#ccc",t.fillRect(0,0,e,i),t.fillStyle="#FFF",t.textAlign="center",t.restore(),t.save(),t.translate(n.x,n.y),this.player.draw(t),this.enemy.draw(t),t.restore(),this.drawUiBar(t),this.drawEnemyUiBar(t,e,i),this.playersTurn&&this.battleMenu.draw(t,n,this.player)}},{key:"drawUiBar",value:function(t){t.save(),t.fillStyle="#000",t.fillRect(0,0,512,48),t.fillStyle="#FFF",t.font="20px Arial",t.fillText("HP : "+this.player.stats.hp,16,32),t.restore()}},{key:"drawEnemyUiBar",value:function(t,e,i){t.save(),t.translate(e-512,0),t.fillStyle="#000",t.fillRect(0,0,512,48),t.fillStyle="#FFF",t.font="20px Arial",t.fillText("HP : "+this.enemy.stats.hp,16,32),t.restore()}}])&&It(e.prototype,i),n&&It(e,n),t}();function Ft(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var zt=function(){function t(e,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.resolution=new a(e,i),this.resize(e,i),this.levelNumber=0,this.offset=new a(0,0),this.battle=null,this.state="start-menu",this.states=["start-menu","play","pause","inventory","battle"],this.menu=new gt,this.inventory=new jt,_handler.register(this),this.init()}var e,i,n;return e=t,(i=[{key:"loadLevel",value:function(t){var e=t.obj.portal_to.match(/^(\d+)\.(\d+)$/),i=ct[parseInt(e[1])][parseInt(e[2])],n=t.obj;this.level.reload(i,n)}},{key:"start",value:function(){this.level=new ut(ct[0][0])}},{key:"update",value:function(t){var e=this;if(this.menu.active?this.lock("start-menu"):this.inventory.active?this.lock("inventory"):this.battle&&this.battle.active?this.battle.update(t):this.unlock(),"playing"===this.state){var i=this.level.update(t);i.length&&i.forEach(function(t){(t.type="enter_portal")&&e.loadLevel(t)}),this.battle&&this.battle.active?(this.offset.x=0,this.offset.y=0):(this.offset.x=this.width/2-this.level.player.pos.x,this.offset.y=this.height/2-this.level.player.pos.y)}}},{key:"resize",value:function(t,e){this.width=t,this.height=e}},{key:"lock",value:function(t){this.state=t,this.level.player.lock()}},{key:"unlock",value:function(){this.level.player.unlock(),this.state="playing"}},{key:"register",value:function(){var t=this;return{battle:function(e){t.battle||(t.battle=new Dt(e.detail.player,e.detail.enemy))}}}},{key:"init",value:function(){this.inventory.store(new Pt({name:"Basic Sword",description:"A basic bitch sword.",attack:3})),this.inventory.store(new Pt({name:"Mace",description:"A fucking mace. Watch out!",attack:10})),this.inventory.store(new Pt({name:"Pole Arm",description:"Swift and strong.",attack:5}))}}])&&Ft(e.prototype,i),n&&Ft(e,n),t}();function Wt(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var Mt=function(){function t(e,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.game=i,this.ctx=e.getContext("2d"),this.buffer=document.createElement("canvas").getContext("2d"),this.triggerResize(this.game.width,this.game.height),_handler.register(this)}var e,i,n;return e=t,(i=[{key:"draw",value:function(t){var e=this;this.buffer.clearRect(0,0,this.game.width,this.game.height),this.buffer.save(),this.buffer.translate(t.x,t.y),this.buffer.fillRect(0,0,this.game.width,this.game.height),this.game.level.map.draw(this.buffer),this.game.level.entities.forEach(function(i){i.draw(e.buffer,t)}),this.game.level.map.draw(this.buffer,!0),this.game.inventory.active&&this.game.inventory.draw(this.buffer,this.game.width,this.game.height,t),this.game.battle&&this.game.battle.active&&this.game.battle.draw(this.buffer,this.game.width,this.game.height),this.game.menu.active&&this.game.menu.draw(this.buffer,this.game.width,this.game.height,t),this.buffer.restore(),this.ctx.clearRect(0,0,this.game.width,this.game.height),this.ctx.drawImage(this.buffer.canvas,0,0,this.buffer.canvas.width,this.buffer.canvas.height,0,0,this.ctx.canvas.width,this.ctx.canvas.height)}},{key:"triggerResize",value:function(){if(window.innerWidth<this.game.resolution.x){var t=this.game.height/this.game.width,e=Math.floor(window.innerWidth),i=Math.floor(window.innerWidth*t);e%2==1&&e--,i%2==1&&i--,this.resize(e,i)}else this.width!==this.game.resolution.x&&this.resize(this.game.resolution.x,this.game.resolution.y)}},{key:"resize",value:function(t,e){this.ctx.canvas.width=t,this.ctx.canvas.height=e,this.ctx.imageSmoothingEnabled=!1,this.buffer.canvas.width=t,this.buffer.canvas.height=e,this.buffer.imageSmoothingEnabled=!1,this.game.resize(t,e)}},{key:"register",value:function(){var t=this;return{resize:function(e){return t.triggerResize()}}}}])&&Wt(e.prototype,i),n&&Wt(e,n),t}();function Bt(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var Lt=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.events={},this.customEvents={}}var e,i,n;return e=t,(i=[{key:"register",value:function(t){var e=this;if("function"!=typeof t.register)throw new Error("Target class does not have event register method");var i=t.register();Array.isArray(i)?i.forEach(function(i){return e.install(t,i)}):this.install(t,i)}},{key:"install",value:function(t,e){var i=this,n=function(n){i.events.hasOwnProperty(n)||(i.events[n]=[],window.addEventListener(n,function(t){i.events[n].forEach(function(e){e.handle(t,i)})})),i.events[n].push({target:t,handle:e[n]})};for(var r in e)n(r)}},{key:"unregister",value:function(t){for(var e in this.events)this.events[e]=this.events[e].filter(function(e){return e.target!==t})}},{key:"trigger",value:function(t,e){var i=new CustomEvent(t,{detail:e});window.dispatchEvent(i)}}])&&Bt(e.prototype,i),n&&Bt(e,n),t}();window._handler=new Lt;var Ut=document.getElementById("game"),qt=(Ut.getContext("2d"),new zt(1280,720)),Ht=new Mt(Ut,qt);qt.start();var Xt=0;requestAnimationFrame(function t(e){var i=e-Xt;Xt=e,qt.update(i),Ht.draw(qt.offset),requestAnimationFrame(t)})}]);